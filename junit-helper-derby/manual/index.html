
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 18 Jan 2016
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>User Guide | JUnit Helper :: Derby</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
 
		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/cosmo/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="../..//css/bootswatch.css" rel="stylesheet" />
		<link href="../..//css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/github.min.css" rel="stylesheet" />

		<link href="../..//css/lightbox.css" rel="stylesheet" />

		<link href="../..//css/site.css" rel="stylesheet" />
		<link href="../..//css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="author" href="http://blog.bindul.name/"/>
	</head>

	<body class="page-manual-index project-junit-helper-derby" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="../../"><span class="color-highlight">JUnit Helper</span> Utils</a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="../../../" title="Development Entropy">Development Entropy</a></li>
							<li ><a href="https://github.com/deventropy/junit-helper" title="JUnit Helper @ GitHub" class="externalLink">JUnit Helper @ GitHub</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../index.html" title="JUnit Helper :: Derby">JUnit Helper :: Derby</a></li>
									<li ><a href="../../junit-helper-utils/index.html" title="JUnit Helper :: Shared Utils">JUnit Helper :: Shared Utils</a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Junit Helper Derby <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../index.html" title="Home">Home</a></li>
									<li class="dropdown-submenu active">
										<a href="" title="User Manual">User Manual</a>
										<ul class="dropdown-menu">
											<li ><a href="configuration.html" title="Configuration">Configuration</a></li>
											<li ><a href="utilities.html" title="Script Runner / Utilities">Script Runner / Utilities</a></li>
											<li ><a href="concurrency.html" title="Parallel Runs">Parallel Runs</a></li>
										</ul>
									</li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../../development.html" title="Development Guide">Development Guide</a></li>
									<li ><a href="https://github.com/deventropy/junit-helper/issues" title="Issues" class="externalLink">Issues</a></li>
									<li ><a href="https://github.com/deventropy/junit-helper#fork-destination-box" title="Fork on GitHub" class="externalLink">Fork on GitHub</a></li>
									<li ><a href="https://travis-ci.org/deventropy/junit-helper" title="Continuous Integration" class="externalLink">Continuous Integration</a></li>
									<li ><a href="https://www.deventropy.org/" title="Development Entropy" class="externalLink">Development Entropy</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="../" id="bannerLeft"><h1><span class="color-highlight">Derby</span> JUnit Helper Utils</h1></a>
					<p class="lead">Utility JUnit resource / libraries to ease DB testing with Apache Derby</p>
				</div>
				<div class="pull-right">
				</div>
			</div>
		</div>
	</div>
		<div>
			<ul class="breadcrumb">
				<li><a href="../../" title="JUnit Helper">JUnit Helper</a></li>
				<li class="divider">/</li>
				<li><a href="../" title="JUnit Helper :: Derby">JUnit Helper :: Derby</a></li>
				<li class="divider">/</li>
				<li>User Guide</li>
			</ul>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<!-- Copyright 2016 JUnit Helper Contributors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License. --> 
<div class="page-header">
 <h1 id="user_guide">User Guide</h1>
</div> 
<ul> 
 <li><a href="#getting-started">Getting Started</a></li> 
 <li><a href="#instance">Managing Derby Instances</a> 
  <ul> 
   <li><a href="#junit-rules">Using JUnit Rules</a></li> 
  </ul></li> 
 <li><a href="#logging">Application Logging</a></li> 
 <li><a href="./configuration.html">Configuration Options</a> 
  <ul> 
   <li><a href="./configuration.html#db-dir">Database Directory</a></li> 
   <li><a href="./configuration.html#db-path">Database Path</a></li> 
   <li><a href="./configuration.html#db-logging">Database Logging</a></li> 
   <li><a href="./configuration.html#sub-sub-protocol">Sub Sub Protocols</a> 
    <ul> 
     <li><a href="./configuration.html#in-memory">In Memory database</a></li> 
     <li><a href="./configuration.html#directory">Database in Directory</a></li> 
    </ul></li> 
   <li><a href="./configuration.html#post-init-script">Post Init Scripts</a></li> 
  </ul></li> 
 <li><a href="./concurrency.html">Managing Concurrency</a></li> 
 <li><a href="./utilities.html">Utilities</a> 
  <ul> 
   <li><a href="./utilities.html#script-runner">Script Runner</a></li> 
   <li><a href="./utilities.html#derby-utils">Derby Utils</a></li> 
  </ul></li> 
</ul> 
<!-- TODO Document internals? DB URL parameters, Derby Home reset, etc. --> 
<div class="section"> 
 <h2 id="Getting_Started"><a name="getting-started"></a>Getting Started</h2> 
 <p>JUnit Helper Derby Utils is a set of classes that aid in building and writing unit tests of database code using <a class="externalLink" href="http://db.apache.org/derby/">Apache Derby</a> embedded database. It has been developed, tested and used with unit tests built on <a class="externalLink" href="http://junit.org">JUnit</a> only; it might work with other testing frameworks, but no claim to such usability is implied. It does not aim to be a general purpose database utility as well.</p> 
 <div class="section"> 
  <h3 id="Dependency_Info">Dependency Info</h3> 
  <p>See the <a href="../dependency-info.html">Dependency Info</a> page to add this project as a dependency to your project; if the use of this library is limited to unit testing only, then add the dependency to the <tt>test</tt> scope only. You may have to add the required <a href="../../index.html#repository">Distribution Repository</a> for resolution.</p> 
  <p>Also see the <a href="../dependencies.html">Project Dependencies</a> for dependencies that come with this project, you may want to exclude some of them to avoid version conflicts if your project has some of those dependencies as well. </p> 
 </div> 
 <div class="section"> 
  <h3 id="Basic_Workflow">Basic Workflow</h3> 
  <p>When unit testing a piece of JDBC code, the steps would be:</p> 
  <ol style="list-style-type: decimal"> 
   <li>Configure and start an in-memory instance of Derby</li> 
   <li>Set up the tables and test data in the instance</li> 
   <li>Run your tests</li> 
   <li>Shut down the database and run cleanup</li> 
  </ol> 
 </div> 
 <div class="section"> 
  <h3 id="Hello_World">Hello World</h3> 
  <p>A small sample test:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>public class SimpleDerbyTest {
	
	private TemporaryFolder tempFolder = new TemporaryFolder();
	private EmbeddedDerbyResource embeddedDerbyResource =
		new EmbeddedDerbyResource(DerbyResourceConfig.buildDefault()
			.useDevNullErrorLogging(),
		tempFolder);
	
	@Rule
	public RuleChain derbyRuleChain = RuleChain.outerRule(tempFolder).around(embeddedDerbyResource);

	@Test
	public void test () throws SQLException {
		final String jdbcUrl = embeddedDerbyResource.getJdbcUrl();
		Connection connection = null;
		Statement stmt = null;
		ResultSet rs = null;

		try {
			connection = DriverManager.getConnection(jdbcUrl);
	
			// Check a value
			stmt = connection.createStatement();
			rs = stmt.executeQuery(&quot;SELECT 1 FROM SYSIBM.SYSDUMMY1&quot;);
	
			assertTrue(rs.next());
		} finally {
			// Close resources
		}
	}
}
</pre> 
   </div> 
  </div> 
  <p>The Derby instance is wrapped inside the <tt>EmbeddedDerbyResource</tt> instance, and it has convenience methods to access the runtime values from the instance (see <i><a href="../apidocs/org/deventropy/junithelper/derby/EmbeddedDerbyResource.html">EmbeddedDerbyResource Javadocs</a></i> for more information on available methods). The instance can be configured using the <tt>DerbyResourceConfig</tt> instance, which provides a <a class="externalLink" href="https://en.wikipedia.org/wiki/Fluent_interface">Fluent Interface</a> to configure runtime parameters (see <i><a href="../apidocs/org/deventropy/junithelper/derby/DerbyResourceConfig.html">javadocs</a></i> for API information). See the <a href="./configuration.html">Configuration Options</a> documentation to see available configurations.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Derby_Instances"><a name="instance"></a>Derby Instances</h2> 
 <p>An <i>Embedded Derby</i> instance can be started and stopped using the <tt>EmbeddedDerbyResource#start()</tt> and <tt>EmbeddedDerbyResource#close()</tt> methods. Users are free to initialize and manage instances on their own (also read about <a href="./concurrency.html">Concurrency</a> when attempting to run multiple concurrent instances of Derby).</p> 
 <p>If the user wants to control the instance and possibly share it across multiple test classes or want more control over the running instance.</p> 
 <div class="section"> 
  <h3 id="Using_JUnit_Rules"><a name="junit-rules"></a>Using JUnit Rules</h3> 
  <p>The <tt>EmbeddedDerbyResource</tt> does extend JUnit <tt>ExternalResource</tt> so can be used as a <a class="externalLink" href="https://github.com/junit-team/junit/wiki/Rules">JUnit Rules</a>. In that case, JUnit test runners will automatically instantiate the external resource and handle shutting down the instance after the execution of the test (using the <tt>EmbeddedDerbyResource#before()</tt> and <tt>EmbeddedDerbyResource#after()</tt> methods which in turn use the <tt>EmbeddedDerbyResource#start()</tt> and <tt>EmbeddedDerbyResource#close()</tt> methods respectively).</p> 
  <p>Derby needs a directory as the <tt>derby.system.home</tt> which can be either a directory that the user code supplies, a Java temporary directory or JUnit <a class="externalLink" href="https://github.com/junit-team/junit/wiki/Rules#temporaryfolder-rule">TemporaryFolder Rule</a> (more at <a href="./configuration.html#db-dir">Database Directory</a>). If the <tt>TemporaryFolder</tt> Rule is used as well as the <tt>EmbeddedDerbyResource</tt> as a JUnit Rule, then the two need to be chained together using a <b><a class="externalLink" href="https://github.com/junit-team/junit/wiki/Rules#rulechain">RuleChain</a></b> to tie the <tt>#before()</tt> and <tt>#after()</tt> methods in order. The following sample shows a sample use:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>private TemporaryFolder tempFolder = new TemporaryFolder();
private EmbeddedDerbyResource embeddedDerbyResource =
	new EmbeddedDerbyResource(DerbyResourceConfig.buildDefault(), tempFolder);

@ClassRule
public RuleChain derbyRuleChain = RuleChain.outerRule(tempFolder).around(embeddedDerbyResource);
</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Application_Logging"><a name="logging"></a>Application Logging</h2> 
 <p>Derby JUnit Helper uses <a class="externalLink" href="http://logging.apache.org/log4j/2.x/manual/api.html">Log4j2 API</a> for the little bit of logging it sends. It does not have a default log configuration with the distribution, neither does it come with a runtime logger. Users are free to provide their own configuration and runtime logger as a dependency; or live with no logging and a 2 line Log4j warning on each JVM run.</p> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#user_guide" title="User Guide">User Guide <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li class="dropdown"><a href="#Getting_Started" title="Getting Started">Getting Started <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Dependency_Info" title="Dependency Info">Dependency Info</a>
		<li><a href="#Basic_Workflow" title="Basic Workflow">Basic Workflow</a>
		<li><a href="#Hello_World" title="Hello World">Hello World</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Derby_Instances" title="Derby Instances">Derby Instances <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Using_JUnit_Rules" title="Using JUnit Rules">Using JUnit Rules</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li><a href="#Application_Logging" title="Application Logging">Application Logging</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="../../" title="Home">Home</a>
						</li>
						<li >
							<a href="https://github.com/deventropy/junit-helper" title="GitHub project" class="externalLink">GitHub project</a>
						</li>
						<li class="nav-header">Junit Helper Derby</li>
						<li >
							<a href="../index.html" title="Home">Home</a>
						</li>
						<li >
							<a href="#" title="User Manual">User Manual <i class="icon-chevron-down"></i></a>
							<ul class="nav nav-list">
						<li >
							<a href="configuration.html" title="Configuration">Configuration</a>
						</li>
						<li >
							<a href="utilities.html" title="Script Runner / Utilities">Script Runner / Utilities</a>
						</li>
						<li >
							<a href="concurrency.html" title="Parallel Runs">Parallel Runs</a>
						</li>
							</ul>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Modules</li>
						<li >
							<a href="../index.html" title="JUnit Helper :: Derby">JUnit Helper :: Derby</a>
						</li>
						<li >
							<a href="../../junit-helper-utils/index.html" title="JUnit Helper :: Shared Utils">JUnit Helper :: Shared Utils</a>
						</li>
						<li class="nav-header">Development</li>
						<li >
							<a href="../../development.html" title="Development Guide">Development Guide</a>
						</li>
						<li >
							<a href="https://github.com/deventropy/junit-helper/issues" title="Issues" class="externalLink">Issues</a>
						</li>
						<li >
							<a href="https://github.com/deventropy/junit-helper#fork-destination-box" title="Fork on GitHub" class="externalLink">Fork on GitHub</a>
						</li>
						<li >
							<a href="https://travis-ci.org/deventropy/junit-helper" title="Continuous Integration" class="externalLink">Continuous Integration</a>
						</li>
						<li >
							<a href="https://www.deventropy.org/" title="Development Entropy" class="externalLink">Development Entropy</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Legal</li>
						<li >
							<a href="../../license.html" title="License">License</a>
						</li>
						<li >
							<a href="../../privacy.html" title="Privacy Policy">Privacy Policy</a>
						</li>
						<li class="nav-header">Maven documentation</li>
						<li >
							<a href="../project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
						<li >
							<a href="../project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<blockquote><span class="color-highlight">JUnit Helper</span> Utils is a collection of (mostly) External Resources
		          built for <a href="http://junit.org/" title="JUnit">JUnit</a>. They aid in developing test cases using
		          external resources, like databases, HTTP servers, etc.</blockquote>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2015-2016 <a href="http://www.deventropy.org/">Development Entropy Projects</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 1.0-alpha.1-SNAPSHOT. </span><span class="publishDate">Last Published: 18 Jan 2016. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="../..//js/lightbox.min.js"></script>
	<script src="../..//js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="../..//js/reflow-skin.js"></script>

	</body>
</html>
